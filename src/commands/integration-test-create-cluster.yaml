parameters:
  kind-config:
    type: string
steps:
  - unless:
      condition: << parameters.kind-config >>
      steps:
        - run:
            name: "Prepare default kind config"
            command: |
              echo "kind: Cluster" >> << parameters.kind-config >>
              echo "apiVersion: kind.sigs.k8s.io/v1alpha3" >> << parameters.kind-config >>
  - run:
      name: "Create cluster"
      command: |
        kind create cluster --config  << parameters.kind-config >>  --image quay.io/giantswarm/kind-node:$KUBERNETES_VERSION
